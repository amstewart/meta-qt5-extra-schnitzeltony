From 177c88149d083255f9484d7efdf84d64e7b59805 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andreas=20M=C3=BCller?= <schnitzeltony@gmail.com>
Date: Sat, 11 Jun 2022 21:55:34 +0200
Subject: [PATCH] Revert "Simplify header install locations"
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Not prefixing can cause trouble in oe-builds when not using extra-cmake

This reverts commit 42a061b04c507de11b0fb240808fc65a7528d946.

Signed-off-by: Andreas MÃ¼ller <schnitzeltony@gmail.com>
---
 src/lib/CMakeLists.txt | 20 +++++++++++++++++++-
 1 file changed, 19 insertions(+), 1 deletion(-)

diff --git a/src/lib/CMakeLists.txt b/src/lib/CMakeLists.txt
index 74ddfee8..a74dc4b7 100644
--- a/src/lib/CMakeLists.txt
+++ b/src/lib/CMakeLists.txt
@@ -72,17 +72,35 @@ set(Forwarding_Header_Names
 ecm_generate_headers(CamelCase_HEADERS
     HEADER_NAMES ${Forwarding_Header_Names}
     REQUIRED_HEADERS SyntaxHighlighting_HEADERS
+    PREFIX KSyntaxHighlighting
 )
 
 install(TARGETS KF5SyntaxHighlighting EXPORT KF5SyntaxHighlightingTargets ${KDE_INSTALL_TARGETS_DEFAULT_ARGS})
 
 install(FILES
     ${CamelCase_HEADERS}
+    DESTINATION ${KDE_INSTALL_INCLUDEDIR_KF}/KSyntaxHighlighting/KSyntaxHighlighting
+)
+install(FILES
     ${SyntaxHighlighting_HEADERS}
     ${CMAKE_CURRENT_BINARY_DIR}/ksyntaxhighlighting_export.h
-    DESTINATION ${KDE_INSTALL_INCLUDEDIR_KF}/KSyntaxHighlighting/KSyntaxHighlighting
+    DESTINATION ${KDE_INSTALL_INCLUDEDIR_KF}/KSyntaxHighlighting/ksyntaxhighlighting
 )
 
+# TODO KF6: remove this, backward compatible headers location
+if(QT_MAJOR_VERSION STREQUAL "5")
+    ecm_generate_headers(Compat_CamelCase_HEADERS
+        HEADER_NAMES ${Forwarding_Header_Names}
+        REQUIRED_HEADERS Compat_SyntaxHighlighting_HEADERS
+    )
+    install(FILES
+        ${Compat_CamelCase_HEADERS}
+        ${Compat_SyntaxHighlighting_HEADERS}
+        ${CMAKE_CURRENT_BINARY_DIR}/ksyntaxhighlighting_export.h
+        DESTINATION ${KDE_INSTALL_INCLUDEDIR_KF}/KSyntaxHighlighting
+    )
+endif()
+
 if(BUILD_QCH)
     ecm_add_qch(
         KF5SyntaxHighlighting_QCH
-- 
2.34.3

